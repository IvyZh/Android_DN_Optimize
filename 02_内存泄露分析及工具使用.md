录制时间：2016.11.04
老师:Ricky

> `Lsn2_内存泄露分析及工具使用1_2016-11-04_recv`
> `Lsn2_内存泄露分析及工具使用2_2016-11-04_recv`

### 回顾

内存泄露例子 

	单例模式导致内存对象无法释放而导致内存泄露
	
	MainActivity在内存当中泄露了。
	这个故事告诉我们能用Application的context就用Application的
	CommonUtil生命周期跟MainActivity不一致，而是跟Application进程同生同死。
	
	
	旋转3次：会在内存里面开辟三个MainActivity
	实际上3次以上都只会有2个MainActivity。当GC回收的时候会将除了第0个和最后这一个留着其他的都会被回收。
	
	优化两个情况：
		1.主动；平时
		2.被动，很卡的时候  出现问题的时候。
	
	如果我们不知道代码内存泄露的情况，如何判断我们的项目里面有哪些是有内存泄露情况的？
	
	1.凭借工具结合自己的经验来判断。
	往往我们的app在某个时候或者某个操作以后会出现很卡的现象。
	
	1）判断就是查看内存抖动情况
	
	Android Monitor
	MAT (对Eclipse插件使用的，也有独立分析工具)
	
	查找引用了该对象的外部对象有哪些，
	然后一个一个去猜，查找可能内存泄露的嫌疑犯，依据：看(读代码和猜)他们的生命周期是否一致(可以通过快照对比)，如果生命周期一致了肯定不是元凶。

旋转3次：

![](http://1)

GC之后：

![](http://2)

MAT独立版使用：

![](http://3)

![](http://4)

![](http://5)


---

第二小节：

![](http://6-10)

再举一个内存泄露的例子：

![](http://11)

![](http://12)

![](http://13)

旋转屏幕：

![](http://14)

发现gc之后，内存还是增长的

解决办法：

![](http://5)


---

END.



